<!DOCTYPE html>
<html>
<head>
    <title>ModoPayments</title>
    <!-- needed for adaptive design -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

    <!--
    ReDoc doesn't change outer page styles
    -->
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        .powered-by-badge{
	        display:none;
        },
        .api-info-header + p{
            display: none !important;
        }
    </style>
    <script src="https://cdn.vaadin.com/vaadin-core-elements/latest/webcomponentsjs/webcomponents-lite.min.js"></script>
    <link rel="import" href="https://cdn.vaadin.com/vaadin-core-elements/latest/vaadin-combo-box/vaadin-combo-box.html">

</head>
<body>
    <header is="dom-bind" id="docs" hidden>
        <vaadin-combo-box label="Environment" class="env"></vaadin-combo-box> <vaadin-combo-box label="Version" class="version" style="display: none"></vaadin-combo-box>
    </header>

<style>
    vaadin-combo-box {
        max-width: 300px;
        display: inline-block;
        text-align: left;
    }
    header{
        text-align: right;
        padding-right: 20px;
    }
</style>

<redoc></redoc>
<script src="https://rebilly.github.io/ReDoc/releases/latest/redoc.min.js">
</script>
<script>
    $(document).ready(function() {

    	$(".api-info-header + p").hide();
       $(document).on("click", function(e) {
           if ( window.history && window.history.pushState ) {
               window.history.pushState('', '', window.location.pathname)
           } else {
               window.location.href = window.location.href.replace(/#.*$/, '#');
           }
       });
        var docs = document.querySelector('#docs');
        window.addEventListener('WebComponentsReady', function() {
            $.getJSON("./config.json").then(function(data){
                window.config = data;
                var env = [];
                for (i in window.config.versions) {
                    env.push(i);
                }
                $(".env")[0].items = env;
                window.env = env;
                window.version = [];
                docs.removeAttribute("hidden");
            });

			$(".env").on("selected-item-changed", function(e) {
				var docs = document.querySelector('#docs');
				docs.version = [];
				var versions = window.config.versions[e.detail.value];
				for (i in versions) {
					docs.version.push(i);
				}
				$(".version")[0].items = docs.version;
				$(".version").show();
				window.selected_env = e.detail.value;
			});

            $(".version").on("selected-item-changed", function(e) {
                //https://s3.amazonaws.com/coin-manager.docs/dev/1.1.0.json
                window.selected_version = e.detail.value;
                Redoc.init("https://s3.amazonaws.com/"+ window.config.docs_bucket +"/"+selected_env+"/"+selected_version+".json",{
                    "scroll-y-offset":130
                });
            })
        });

    });
    </script>
</body>
</html>