{"id":"NYB/","dependencies":[{"name":"/home/john/workspace/Valory2/tsconfig.json","includedInParent":true,"mtime":1531152310742},{"name":"/home/john/workspace/Valory2/package.json","includedInParent":true,"mtime":1533664046105},{"name":"/home/john/workspace/Valory2/.babelrc","includedInParent":true,"mtime":1533664058125},{"name":"../utils/decoratorUtils","loc":{"line":3,"column":33},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/utils/decoratorUtils.ts"},{"name":"../utils/jsDocUtils","loc":{"line":4,"column":29},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/utils/jsDocUtils.ts"},{"name":"./exceptions","loc":{"line":5,"column":29},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/exceptions.ts"},{"name":"./metadataGenerator","loc":{"line":6,"column":36},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/metadataGenerator.ts"},{"name":"./parameterGenerator","loc":{"line":7,"column":37},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts"},{"name":"./resolveType","loc":{"line":8,"column":30},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/resolveType.ts"}],"generated":{"js":"var $NYB$exports={};Object.defineProperty($NYB$exports,\"__esModule\",{value:!0});const $NYB$var$decoratorUtils_1=$parcel$require(\"NYB/\",\"../utils/decoratorUtils\"),$NYB$var$jsDocUtils_1=$parcel$require(\"NYB/\",\"../utils/jsDocUtils\"),$NYB$var$exceptions_1=$parcel$require(\"NYB/\",\"./exceptions\"),$NYB$var$metadataGenerator_1=$parcel$require(\"NYB/\",\"./metadataGenerator\"),$NYB$var$parameterGenerator_1=$parcel$require(\"NYB/\",\"./parameterGenerator\"),$NYB$var$resolveType_1=$parcel$require(\"NYB/\",\"./resolveType\");class $NYB$var$MethodGenerator{constructor(e,t,r){this.node=e,this.parentTags=t,this.parentSecurity=r,this.processMethodDecorators()}IsValid(){return!!this.method}Generate(){if(!this.IsValid())throw new $NYB$var$exceptions_1.GenerateMetadataError(\"This isn't a valid a controller method.\");let e=this.node.type;if(!e){const t=$NYB$var$metadataGenerator_1.MetadataGenerator.current.typeChecker,r=t.getSignatureFromDeclaration(this.node),a=t.getReturnTypeOfSignature(r);e=t.typeToTypeNode(a)}const t=$NYB$var$resolveType_1.resolveType(e),r=this.getMethodResponses();return r.push(this.getMethodSuccessResponse(t)),{deprecated:$NYB$var$jsDocUtils_1.isExistJSDocTag(this.node,e=>\"deprecated\"===e.tagName.text),description:$NYB$var$jsDocUtils_1.getJSDocDescription(this.node),isHidden:this.getIsHidden(),method:this.method,name:this.node.name.text,parameters:this.buildParameters(),path:this.path,responses:r,security:this.getSecurity(),summary:$NYB$var$jsDocUtils_1.getJSDocComment(this.node,\"summary\"),tags:this.getTags(),type:t}}buildParameters(){for(var e=this.node.parameters,t=e=>{try{return new $NYB$var$parameterGenerator_1.ParameterGenerator(e,this.method,this.path).Generate()}catch(e){const t=this.node.name,r=this.node.parent.name;throw new $NYB$var$exceptions_1.GenerateMetadataError(`${e.message} \\n in '${r.text}.${t.text}'`)}},r=[],a=0;a<e.length;a++)r.push(t(e[a]));const o=r,n=o.filter(e=>\"body\"===e.in),s=o.filter(e=>\"body-prop\"===e.in);if(n.length>1)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one body parameter allowed in '${this.getCurrentLocation()}' method.`);if(n.length>0&&s.length>0)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Choose either during @Body or @BodyProp in '${this.getCurrentLocation()}' method.`);return o}getCurrentLocation(){const e=this.node.name;return`${this.node.parent.name.text}.${e.text}`}processMethodDecorators(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>this.supportsPathMethod(e.text));if(!e||!e.length)return;if(e.length>1){for(var t=e,r=e=>e.text,a=[],o=0;o<t.length;o++)a.push(r(t[o]));throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one path decorator in '${this.getCurrentLocation}' method,\\n       Found: ${a.join(\", \")}`)}const n=e[0],s=n.parent.arguments[0];this.method=n.text.toLowerCase(),this.path=s?`${s.text}`:\"\"}getMethodResponses(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"Response\"===e.text);if(!e||!e.length)return[];for(var t=e,r=e=>{const t=e.parent;let r,a=\"\",o=\"200\";if(t.arguments.length>0&&t.arguments[0].text&&(o=t.arguments[0].text),t.arguments.length>1&&t.arguments[1].text&&(a=t.arguments[1].text),t.arguments.length>2&&t.arguments[2].text){const e=t.arguments[2];r=this.getExamplesValue(e)}return{description:a,examples:r,name:o,schema:t.typeArguments&&t.typeArguments.length>0?$NYB$var$resolveType_1.resolveType(t.typeArguments[0]):void 0}},a=[],o=0;o<t.length;o++)a.push(r(t[o]));return a}getMethodSuccessResponse(e){const t=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"SuccessResponse\"===e.text);if(!t||!t.length)return{description:\"void\"===e.dataType?\"No content\":\"Ok\",examples:this.getMethodSuccessExamples(),name:\"void\"===e.dataType?\"204\":\"200\",schema:e};if(t.length>1)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one SuccessResponse decorator allowed in '${this.getCurrentLocation}' method.`);const r=t[0].parent;let a=\"\",o=\"200\";return r.arguments.length>0&&r.arguments[0].text&&(o=r.arguments[0].text),r.arguments.length>1&&r.arguments[1].text&&(a=r.arguments[1].text),{description:a,examples:void 0,name:o,schema:e}}getMethodSuccessExamples(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"Example\"===e.text);if(!e||!e.length)return;if(e.length>1)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one Example decorator allowed in '${this.getCurrentLocation}' method.`);const t=e[0].parent.arguments[0];return this.getExamplesValue(t)}supportsPathMethod(e){return[\"get\",\"post\",\"put\",\"patch\",\"delete\"].some(t=>t===e.toLowerCase())}getExamplesValue(e){const t={};for(var r,a=e.properties,o=0;o<a.length;o++)r=a[o],t[r.name.text]=$NYB$var$resolveType_1.getInitializerValue(r.initializer);return t}getTags(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"Tags\"===e.text);if(!e||!e.length)return this.parentTags;if(e.length>1)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one Tags decorator allowed in '${this.getCurrentLocation}' method.`);for(var t=e[0].parent.arguments,r=e=>e.text,a=[],o=0;o<t.length;o++)a.push(r(t[o]));const n=a;return this.parentTags&&n.push(...this.parentTags),n}getIsHidden(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"Hidden\"===e.text);if(!e||!e.length)return!1;if(e.length>1)throw new $NYB$var$exceptions_1.GenerateMetadataError(`Only one Hidden decorator allowed in '${this.getCurrentLocation}' method.`);return!0}getSecurity(){const e=$NYB$var$decoratorUtils_1.getDecorators(this.node,e=>\"Security\"===e.text);if(!e||!e.length)return this.parentSecurity||[];const t=[];for(const r of e){const e=r.parent;t.push({name:e.arguments[0].text,scopes:e.arguments[1]?e.arguments[1].elements.map(e=>e.text):void 0})}return t}}var $NYB$export$MethodGenerator=$NYB$var$MethodGenerator;$NYB$exports.MethodGenerator=$NYB$export$MethodGenerator;"},"hash":"9cdb49e050d0972b34d52124edf37957","cacheData":{"env":{},"imports":{},"exports":{"MethodGenerator":"$NYB$export$MethodGenerator"},"wildcards":[],"isCommonJS":true}}