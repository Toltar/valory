{"id":"/vQc","dependencies":[{"name":"/home/john/workspace/Valory2/tsconfig.json","includedInParent":true,"mtime":1531152310742},{"name":"/home/john/workspace/Valory2/package.json","includedInParent":true,"mtime":1533664046105},{"name":"/home/john/workspace/Valory2/.babelrc","includedInParent":true,"mtime":1533664058125},{"name":"../utils/decoratorUtils","loc":{"line":11,"column":33},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/controllerGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/utils/decoratorUtils.ts"},{"name":"./exceptions","loc":{"line":12,"column":29},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/controllerGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/exceptions.ts"},{"name":"./methodGenerator","loc":{"line":13,"column":34},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/controllerGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/methodGenerator.ts"},{"name":"./metadataGenerator","loc":{"line":14,"column":36},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/controllerGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/metadataGenerator.ts"},{"name":"../../lib/config","loc":{"line":15,"column":25},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/controllerGenerator.ts","resolved":"/home/john/workspace/Valory2/src/lib/config.ts"}],"generated":{"js":"var $vQc$exports={},$vQc$var$__importStar=$vQc$exports&&$vQc$exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty($vQc$exports,\"__esModule\",{value:!0});const $vQc$var$ts=$vQc$var$__importStar(require(\"typescript\")),$vQc$var$decoratorUtils_1=$parcel$require(\"/vQc\",\"../utils/decoratorUtils\"),$vQc$var$exceptions_1=$parcel$require(\"/vQc\",\"./exceptions\"),$vQc$var$methodGenerator_1=$parcel$require(\"/vQc\",\"./methodGenerator\"),$vQc$var$metadataGenerator_1=$parcel$require(\"/vQc\",\"./metadataGenerator\"),$vQc$var$config_1=$parcel$require(\"/vQc\",\"../../lib/config\");class $vQc$var$ControllerGenerator{constructor(e){this.node=e,this.path=this.getPath(),this.tags=this.getTags(),this.security=this.getSecurity()}IsValid(){return!!this.path||\"\"===this.path}Generate(){if(!this.node.parent)throw new $vQc$var$exceptions_1.GenerateMetadataError(\"Controller node doesn't have a valid parent source file.\");if(!this.node.name)throw new $vQc$var$exceptions_1.GenerateMetadataError(\"Controller node doesn't have a valid name.\");if(!this.isNodeExported())throw new $vQc$var$exceptions_1.GenerateMetadataError(\"Controller node must be exported.\");const e=this.node.parent.getSourceFile();if(e.fileName===$vQc$var$config_1.Config.ConfigData.sourceEntrypoint)throw new $vQc$var$exceptions_1.GenerateMetadataError(\"Controller node not allowed in app entrypoint.\");let t=!1;const r=$vQc$var$metadataGenerator_1.MetadataGenerator.current.typeChecker;if(null!=this.node.heritageClauses)for(var o=this.node.heritageClauses,a=e=>{for(const o of e.types){\"Controller\"===r.getTypeFromTypeNode(o).symbol.escapedName&&(t=!0)}},n=0;n<o.length;n++)a(o[n]);return{location:e.fileName,methods:this.buildMethods(),name:this.node.name.text,path:this.path||\"\",extendsController:t}}buildMethods(){for(var e=this.node.members.filter(e=>e.kind===$vQc$var$ts.SyntaxKind.MethodDeclaration),t=e=>new $vQc$var$methodGenerator_1.MethodGenerator(e,this.tags,this.security),r=[],o=0;o<e.length;o++)r.push(t(e[o]));for(var a=r.filter(e=>e.IsValid()),n=e=>e.Generate(),s=[],i=0;i<a.length;i++)s.push(n(a[i]));return s}getPath(){const e=$vQc$var$decoratorUtils_1.getDecorators(this.node,e=>\"Route\"===e.text);if(!e||!e.length)return;if(e.length>1)throw new $vQc$var$exceptions_1.GenerateMetadataError(`Only one Route decorator allowed in '${this.node.name.text}' class.`);const t=e[0].parent.arguments[0];return t?`${t.text}`:\"\"}getTags(){const e=$vQc$var$decoratorUtils_1.getDecorators(this.node,e=>\"Tags\"===e.text);if(e&&e.length){if(e.length>1)throw new $vQc$var$exceptions_1.GenerateMetadataError(`Only one Tags decorator allowed in '${this.node.name.text}' class.`);for(var t=e[0].parent.arguments,r=e=>e.text,o=[],a=0;a<t.length;a++)o.push(r(t[a]));return o}}getSecurity(){const e=$vQc$var$decoratorUtils_1.getDecorators(this.node,e=>\"Security\"===e.text);if(!e||!e.length)return[];const t=[];for(const r of e){const e=r.parent;t.push({name:e.arguments[0].text,scopes:e.arguments[1]?e.arguments[1].elements.map(e=>e.text):void 0})}return t}isNodeExported(){return 0!=($vQc$var$ts.getCombinedModifierFlags(this.node)&$vQc$var$ts.ModifierFlags.Export)}}var $vQc$export$ControllerGenerator=$vQc$var$ControllerGenerator;$vQc$exports.ControllerGenerator=$vQc$export$ControllerGenerator;"},"hash":"e4ec0397f6922522e0a889e19fb77aab","cacheData":{"env":{},"imports":{},"exports":{"ControllerGenerator":"$vQc$export$ControllerGenerator"},"wildcards":[],"isCommonJS":true}}