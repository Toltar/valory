{"id":"kBZt","dependencies":[{"name":"/home/john/workspace/Valory2/tsconfig.json","includedInParent":true,"mtime":1531152310742},{"name":"/home/john/workspace/Valory2/package.json","includedInParent":true,"mtime":1533664046105},{"name":"/home/john/workspace/Valory2/.babelrc","includedInParent":true,"mtime":1533664058125},{"name":"../utils/decoratorUtils","loc":{"line":11,"column":33},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/utils/decoratorUtils.ts"},{"name":"../utils/validatorUtils","loc":{"line":12,"column":33},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/utils/validatorUtils.ts"},{"name":"./exceptions","loc":{"line":13,"column":29},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/exceptions.ts"},{"name":"./metadataGenerator","loc":{"line":14,"column":36},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/metadataGenerator.ts"},{"name":"./resolveType","loc":{"line":15,"column":30},"parent":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/parameterGenerator.ts","resolved":"/home/john/workspace/Valory2/src/tsoa/metadataGeneration/resolveType.ts"}],"generated":{"js":"var $kBZt$exports={},$kBZt$var$__importStar=$kBZt$exports&&$kBZt$exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty($kBZt$exports,\"__esModule\",{value:!0});const $kBZt$var$ts=$kBZt$var$__importStar(require(\"typescript\")),$kBZt$var$decoratorUtils_1=$parcel$require(\"kBZt\",\"../utils/decoratorUtils\"),$kBZt$var$validatorUtils_1=$parcel$require(\"kBZt\",\"../utils/validatorUtils\"),$kBZt$var$exceptions_1=$parcel$require(\"kBZt\",\"./exceptions\"),$kBZt$var$metadataGenerator_1=$parcel$require(\"kBZt\",\"./metadataGenerator\"),$kBZt$var$resolveType_1=$parcel$require(\"kBZt\",\"./resolveType\"),$kBZt$var$lodash_1=require(\"lodash\");class $kBZt$var$ParameterGenerator{constructor(e,t,r){this.parameter=e,this.method=t,this.path=r}Generate(){switch($kBZt$var$decoratorUtils_1.getDecoratorName(this.parameter,e=>this.supportParameterDecorator(e.text))){case\"Logger\":return this.getLoggerParameter(this.parameter);case\"Request\":return this.getRequestParameter(this.parameter);case\"Body\":return this.getBodyParameter(this.parameter);case\"BodyProp\":return this.getBodyPropParameter(this.parameter);case\"Header\":return this.getHeaderParameter(this.parameter);case\"Query\":return this.getQueryParameter(this.parameter);case\"Path\":default:return this.getPathParameter(this.parameter)}}getRequestParameter(e){const t=e.name.text;return{description:this.getParameterDescription(e),in:\"request\",name:t,parameterName:t,required:!e.questionToken&&!e.initializer,type:{dataType:\"object\"},validators:$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getLoggerParameter(e){const t=e.name.text;return{description:\"\",in:\"logger\",name:t,parameterName:t,required:!0,type:{dataType:\"object\"},validators:{}}}getBodyPropParameter(e){const t=e.name.text,r=this.getValidatedType(e);if(!this.supportBodyMethod(this.method))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@BodyProp('${t}') Can't support in ${this.method.toUpperCase()} method.`);return{default:$kBZt$var$resolveType_1.getInitializerValue(e.initializer,r),description:this.getParameterDescription(e),in:\"body-prop\",name:$kBZt$var$decoratorUtils_1.getDecoratorTextValue(this.parameter,e=>\"BodyProp\"===e.text)||t,parameterName:t,required:!e.questionToken&&!e.initializer,type:r,validators:$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getBodyParameter(e){const t=e.name.text,r=this.getValidatedType(e);if(!this.supportBodyMethod(this.method))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Body('${t}') Can't support in ${this.method.toUpperCase()} method.`);return{description:this.getParameterDescription(e),in:\"body\",name:t,parameterName:t,required:!e.questionToken&&!e.initializer,type:r,validators:$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getHeaderParameter(e){const t=e.name.text;let r=this.getValidatedType(e,!1),a=null;if(\"refAlias\"===r.dataType&&(r=(a=r).type),!this.supportPathDataType(r))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Header('${t}') Can't support '${r.dataType}' type.`);return{default:$kBZt$var$resolveType_1.getInitializerValue(e.initializer,r),description:this.getParameterDescription(e)||(null!=a?a.description:void 0),in:\"header\",name:$kBZt$var$decoratorUtils_1.getDecoratorTextValue(this.parameter,e=>\"Header\"===e.text)||t,parameterName:t,required:!e.questionToken&&!e.initializer,type:r,validators:null!=a?$kBZt$var$lodash_1.merge({},a.validators,$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)):$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getQueryParameter(e){const t=e.name.text;let r=this.getValidatedType(e,!1),a=null;if(\"refAlias\"===r.dataType&&(r=(a=r).type),\"array\"===r.dataType){const e=r;if(!this.supportPathDataType(e.elementType))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Query('${t}') Can't support array '${e.elementType.dataType}' type.`)}else if(!this.supportPathDataType(r))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Query('${t}') Can't support '${r.dataType}' type.`);return{default:$kBZt$var$resolveType_1.getInitializerValue(e.initializer,r),description:this.getParameterDescription(e)||(null!=a?a.description:void 0),in:\"query\",name:$kBZt$var$decoratorUtils_1.getDecoratorTextValue(this.parameter,e=>\"Query\"===e.text)||t,parameterName:t,required:!e.questionToken&&!e.initializer,type:r,validators:null!=a?$kBZt$var$lodash_1.merge({},a.validators,$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)):$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getPathParameter(e){const t=e.name.text;let r=this.getValidatedType(e,!1);const a=$kBZt$var$decoratorUtils_1.getDecoratorTextValue(this.parameter,e=>\"Path\"===e.text)||t;let i=null;if(\"refAlias\"===r.dataType&&(r=(i=r).type),!this.supportPathDataType(r))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Path('${t}') Can't support '${r.dataType}' type.`);if(!this.path.includes(`{${a}}`))throw new $kBZt$var$exceptions_1.GenerateMetadataError(`@Path('${t}') Can't match in URL: '${this.path}'.`);return{default:$kBZt$var$resolveType_1.getInitializerValue(e.initializer,r),description:this.getParameterDescription(e)||(null!=i?i.description:void 0),in:\"path\",name:a,parameterName:t,required:!0,type:r,validators:null!=i?$kBZt$var$lodash_1.merge({},i.validators,$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)):$kBZt$var$validatorUtils_1.getParameterValidators(this.parameter,t)}}getParameterDescription(e){const t=$kBZt$var$metadataGenerator_1.MetadataGenerator.current.typeChecker.getSymbolAtLocation(e.name);if(!t)return;const r=t.getDocumentationComment(void 0);return r.length?$kBZt$var$ts.displayPartsToString(r):void 0}supportBodyMethod(e){return[\"post\",\"put\",\"patch\"].some(t=>t===e.toLowerCase())}supportParameterDecorator(e){return[\"header\",\"query\",\"parem\",\"body\",\"bodyprop\",\"request\",\"logger\"].some(t=>t===e.toLocaleLowerCase())}supportPathDataType(e){return[\"string\",\"integer\",\"long\",\"float\",\"double\",\"date\",\"datetime\",\"buffer\",\"boolean\",\"enum\",\"any\"].find(t=>t===e.dataType)}getValidatedType(e,t=!0){let r=e.type;if(!r){const t=$kBZt$var$metadataGenerator_1.MetadataGenerator.current.typeChecker.getTypeAtLocation(e);r=$kBZt$var$metadataGenerator_1.MetadataGenerator.current.typeChecker.typeToTypeNode(t)}return $kBZt$var$resolveType_1.resolveType(r,e,t)}}var $kBZt$export$ParameterGenerator=$kBZt$var$ParameterGenerator;$kBZt$exports.ParameterGenerator=$kBZt$export$ParameterGenerator;"},"hash":"b8b3a25d245726dcd9762a02358ad134","cacheData":{"env":{},"imports":{},"exports":{"ParameterGenerator":"$kBZt$export$ParameterGenerator"},"wildcards":[],"isCommonJS":true}}